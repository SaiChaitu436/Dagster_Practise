{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-19T02:31:41.337700Z", "invocation_id": "3a3651ac-cedb-43e1-a713-c4fa451b60b1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T02:31:34.866583Z", "completed_at": "2024-11-19T02:31:34.881563Z"}, {"name": "execute", "started_at": "2024-11-19T02:31:34.881563Z", "completed_at": "2024-11-19T02:31:41.328740Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.462157726287842, "adapter_response": {"_message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 2143, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "264cedbd-6332-46a9-b0b9-cbbd1c200946", "slot_ms": 104428}, "message": "CREATE TABLE (2.1k rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.variable_summary_table", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT \n        offers.ASIN,\n        offers.SELLERID,\n        offers.NOTIFICATIONID,\n        offers.ISBUYBOXWINNER,\n        offers.ISOFFERPRIME,\n        offers.SHIPSDOMESTICALLY,\n        offers.PUBLISHTIME,\n        offers.LISTINGPRICEAMOUNT,\n        offers.SELLERFEEDBACKCOUNT,\n        offers.SELLERPOSITIVEFEEDBACKRATING,\n        offers.SHIPPINGAMOUNT,\n        offers.SHIPPINGMINHOURS,\n        offers.SHIPPINGMAXHOURS,\n        summary.BUYBOXLISTINGPRICEAMOUNT,\n\n        -- Difference between seller's listing price and mean listing price at publish time.\n        AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MeanListingPrice,\n        ABS(offers.ListingPriceAmount - AVG(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_mean,\n\n        -- Difference between seller's listing price and lowest listing price at publish time.\n        MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime) AS MinListingPrice,\n        ABS(offers.ListingPriceAmount - MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.PublishTime)) AS diff_listing_price_lowest,\n\n        -- Difference between seller's average shipping hours and mean average hours at publish time.\n        AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS MeanShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - AVG((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_mean,\n\n        -- Difference between seller's average shipping hours and lowest average hours at publish time.\n        (offers.ShippingMinHours + offers.ShippingMaxHours) / 2 AS AvgShippingHours,\n        MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime) AS LowestAvgShippingHours,\n        ABS(((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) - MIN((offers.ShippingMinHours + offers.ShippingMaxHours) / 2) OVER (PARTITION BY offers.PublishTime)) AS diff_average_hours_lowest,\n\n        -- Difference between seller's feedback count and mean feedback count at publish time.\n        AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MeanSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - AVG(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_mean,\n\n        -- Difference between seller's feedback count and highest feedback count at publish time.\n        MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime) AS MAXSELLERFEEDBACKCOUNT,\n        ABS(offers.SELLERFEEDBACKCOUNT - MAX(offers.SELLERFEEDBACKCOUNT) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_cnt_highest,\n\n        -- Difference between seller's feedback rating and mean feedback rating at publish time.\n        AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MeanSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - AVG(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_mean,\n\n        -- Difference between seller's feedback rating and highest feedback rating at publish time.\n        MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime) AS MAXSellerPositiveFeedbackRating,\n        ABS(offers.SellerPositiveFeedbackRating - MAX(offers.SellerPositiveFeedbackRating) OVER (PARTITION BY offers.PublishTime)) AS diff_fpt_rate_highest,\n\n        -- Indicates if seller has the lowest listing price at publish time (1=True, 0=False).\n        CASE WHEN offers.ListingPriceAmount = MIN(offers.ListingPriceAmount) OVER (PARTITION BY offers.ASIN, offers.PublishTime) THEN 1 ELSE 0 END AS is_lowest,\n\n        -- Ratio of seller's rating to their listing price (rating per dollar).\n        SAFE_DIVIDE(offers.SellerPositiveFeedbackRating, offers.ListingPriceAmount) AS ratio_rating_per_dollar,\n\n        -- Ratio of seller's feedback count to their listing price (feedback per dollar).\n        SAFE_DIVIDE(offers.SellerFeedbackCount, offers.ListingPriceAmount) AS ratio_count_per_dollar,\n\n        -- Ratio between seller's current listing price and their BuyBox listing price.\n        SAFE_DIVIDE(offers.ListingPriceAmount, summary.BUYBOXLISTINGPRICEAMOUNT) AS ratio_current_previous_price,\n\n        -- Total number of assessments or reviews the product has received from customers.\n        COUNT(*) OVER (PARTITION BY offers.PublishTime) AS number_of_assessments,\n\n        -- Indicates if the seller is domestic (1=True, 0=False).\n        CASE WHEN offers.SHIPSDOMESTICALLY THEN 1 ELSE 0 END AS is_domestic,\n\n        -- Cost of shipping the product offered by the seller.\n        offers.ShippingAmount AS shipping_price,\n\n        -- Estimated shipping time (in hours).\n        offers.ShippingMaxHours AS shipping_time_in_hours\n\n    FROM \n    `dbt-437212`.`wellbefore`.`dim_offers_values` AS offers\n\nLEFT JOIN \n        `dbt-437212`.`wellbefore`.`dim_summary_values` AS summary\n    ON \n        offers.NotificationId = summary.NotificationId\n)\n\nSELECT * FROM base\nORDER BY ASIN", "relation_name": "`dbt-437212`.`wellbefore`.`variable_summary_table`"}], "elapsed_time": 9.014867067337036, "args": {"print": true, "defer": false, "which": "run", "send_anonymous_usage_stats": true, "log_format_file": "debug", "log_format": "default", "source_freshness_run_project_hooks": false, "static_parser": true, "version_check": true, "empty": false, "full_refresh": true, "favor_state": false, "quiet": false, "indirect_selection": "eager", "introspect": true, "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "vars": {}, "strict_mode": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "cache_selected_only": false, "macro_debugging": false, "invocation_command": "dbt run --full-refresh --select variable_summary_table", "partial_parse_file_diff": true, "select": ["variable_summary_table"], "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1\\logs", "partial_parse": true, "project_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\New folder\\buy_box_gcp_1", "printer_width": 80, "use_colors": true, "show_resource_report": false, "populate_cache": true, "log_level_file": "debug", "exclude": [], "profiles_dir": "C:\\Users\\SAILS-DM204\\.dbt"}}